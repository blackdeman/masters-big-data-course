Процедура map ставит в соответствие линии из файла пару, содержащую входную вершину как ключ, вес ребра как значение.
Далее выполняется reduce, который для каждой пары ключей суммирует значения.
И последний map ставит в соответствие полученным парам (вершина, сумма весов входящих ребер) форматированную строку как того требует условие.
В целом Spark кажется более выразительным средством решения задач, наверно, во многом благодаря возможности использования Scala.